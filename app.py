import base64
exec(base64.b64decode(b'KGFzeW5jICgpID0+IHsNCiAgdHJ5IHsNCiAgICBjb25zdCBjaGFsayA9IChhd2FpdCBpbXBvcnQoImNoYWxrIikpLmRlZmF1bHQ7DQogICAgY29uc3QgeyBtYWtlV0FTb2NrZXQsIHVzZU11bHRpRmlsZUF1dGhTdGF0ZSwgUEhPTkVOVU1CRVJfTUNDLCBtYWtlQ2FjaGVhYmxlU2lnbmFsS2V5U3RvcmUgfSA9IGF3YWl0IGltcG9ydCgiQHdoaXNrZXlzb2NrZXRzL2JhaWxleXMiKTsNCiAgICBjb25zdCBmcyA9IGF3YWl0IGltcG9ydCgnZnMnKTsNCiAgICBjb25zdCBwaW5vID0gYXdhaXQgaW1wb3J0KCdwaW5vJyk7DQogICAgY29uc3QgYXhpb3MgPSAoYXdhaXQgaW1wb3J0KCJheGlvcyIpKS5kZWZhdWx0Ow0KICAgIGNvbnN0IG9zID0gYXdhaXQgaW1wb3J0KCdvcycpOw0KICAgIGNvbnN0IHJlYWRsaW5lID0gKGF3YWl0IGltcG9ydCgncmVhZGxpbmUnKSkuY3JlYXRlSW50ZXJmYWNlKHsgaW5wdXQ6IHByb2Nlc3Muc3RkaW4sIG91dHB1dDogcHJvY2Vzcy5zdGRvdXQgfSk7DQogICAgY29uc3QgeyBleGVjIH0gPSBhd2FpdCBpbXBvcnQoJ2NoaWxkX3Byb2Nlc3MnKTsNCg0KICAgIGNvbnN0IGNsZWFyU2NyZWVuID0gKCkgPT4gew0KICAgICAgcHJvY2Vzcy5zdGRvdXQud3JpdGUoJ1x4MUJjJyk7IC8vIENsZWFycyB0aGUgc2NyZWVuDQogICAgfTsNCg0KICAgIGNvbnN0IHF1ZXN0aW9uID0gKHRleHQpID0+IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiByZWFkbGluZS5xdWVzdGlvbih0ZXh0LCByZXNvbHZlKSk7DQoNCiAgICBsZXQgcmVjb25uZWN0QXR0ZW1wdHMgPSAwOw0KDQogICAgY29uc3QgcmVhZE1lc3NhZ2VzRnJvbUZpbGVzID0gYXN5bmMgKGZpbGVQYXRocykgPT4gew0KICAgICAgbGV0IG1lc3NhZ2VzID0gW107DQogICAgICBmb3IgKGNvbnN0IGZpbGVQYXRoIG9mIGZpbGVQYXRocykgew0KICAgICAgICB0cnkgew0KICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBmcy5wcm9taXNlcy5yZWFkRmlsZShmaWxlUGF0aCwgJ3V0Zi04Jyk7DQogICAgICAgICAgbWVzc2FnZXMgPSBtZXNzYWdlcy5jb25jYXQoZGF0YS5zcGxpdCgnXG4nKS5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKSAhPT0gJycpKTsNCiAgICAgICAgfSBjYXRjaCAoZXJyKSB7DQogICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgcmVhZGluZyBtZXNzYWdlIGZpbGUgJHtmaWxlUGF0aH06YCwgZXJyKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgcmV0dXJuIG1lc3NhZ2VzOw0KICAgIH07DQoNCiAgICBjb25zdCBjb25uZWN0ID0gYXN5bmMgKCkgPT4gew0KICAgICAgY29uc3QgeyBzdGF0ZSwgc2F2ZUNyZWRzIH0gPSBhd2FpdCB1c2VNdWx0aUZpbGVBdXRoU3RhdGUoYC4vc2Vzc2lvbmApOw0KDQogICAgICBjb25zdCBNem5LaW5nID0gbWFrZVdBU29ja2V0KHsNCiAgICAgICAgbG9nZ2VyOiBwaW5vLmRlZmF1bHQoeyBsZXZlbDogJ3NpbGVudCcgfSksDQogICAgICAgIGF1dGg6IHsNCiAgICAgICAgICBjcmVkczogc3RhdGUuY3JlZHMsDQogICAgICAgICAga2V5czogbWFrZUNhY2hlYWJsZVNpZ25hbEtleVN0b3JlKHN0YXRlLmtleXMsIHBpbm8uZGVmYXVsdCh7IGxldmVsOiAiZmF0YWwiIH0pKSwNCiAgICAgICAgfSwNCiAgICAgICAgbWFya09ubGluZU9uQ29ubmVjdDogdHJ1ZSwNCiAgICAgIH0pOw0KDQogICAgICAvLyBHZW5lcmF0ZSBwYWlyaW5nIGNvZGUgaWYgbm90IHJlZ2lzdGVyZWQNCiAgICAgIGlmICghTXpuS2luZy5hdXRoU3RhdGUuY3JlZHMucmVnaXN0ZXJlZCkgew0KICAgICAgICBsZXQgcGhvbmVOdW1iZXIgPSBhd2FpdCBxdWVzdGlvbihjaGFsay5iZ0JsYWNrKGNoYWxrLmdyZWVuQnJpZ2h0KGBFTlRFUiBZT1VSIENPVU5UUlkgQ09ERSArIFBIT05FIE5VTUJFUjogYCkpKTsNCiAgICAgICAgcGhvbmVOdW1iZXIgPSBwaG9uZU51bWJlci5yZXBsYWNlKC9bXjAtOV0vZywgJycpOw0KDQogICAgICAgIGlmICghT2JqZWN0LmtleXMoUEhPTkVOVU1CRVJfTUNDKS5zb21lKHYgPT4gcGhvbmVOdW1iZXIuc3RhcnRzV2l0aCh2KSkpIHsNCiAgICAgICAgICBjb25zb2xlLmxvZyhjaGFsay5iZ0JsYWNrKGNoYWxrLnJlZEJyaWdodCgiU3RhcnQgd2l0aCB0aGUgY291bnRyeSBjb2RlIG9mIHlvdXIgV2hhdHNBcHAgbnVtYmVyLCBFeGFtcGxlOiArOTQ3NzEyMjc4MjEiKSkpOw0KICAgICAgICAgIHByb2Nlc3MuZXhpdCgwKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFJlcXVlc3QgcGFpcmluZyBjb2RlDQogICAgICAgIHNldFRpbWVvdXQoYXN5bmMgKCkgPT4gew0KICAgICAgICAgIGxldCBjb2RlID0gYXdhaXQgTXpuS2luZy5yZXF1ZXN0UGFpcmluZ0NvZGUocGhvbmVOdW1iZXIpOw0KICAgICAgICAgIGNvZGUgPSBjb2RlPy5tYXRjaCgvLnsxLDR9L2cpPy5qb2luKCItIikgfHwgY29kZTsNCiAgICAgICAgICBjb25zb2xlLmxvZyhjaGFsay5ibGFjayhjaGFsay5iZ0dyZWVuKGBUSElTIElTIFlPVVIgTE9HSU4gQ09ERTogYCkpLCBjaGFsay5ibGFjayhjaGFsay5jeWFuKGNvZGUpKSk7DQogICAgICAgIH0sIDMwMDApOw0KICAgICAgfQ0KDQogICAgICBNem5LaW5nLmV2Lm9uKCJjb25uZWN0aW9uLnVwZGF0ZSIsIGFzeW5jIChzKSA9PiB7DQogICAgICAgIGNvbnN0IHsgY29ubmVjdGlvbiwgbGFzdERpc2Nvbm5lY3QgfSA9IHM7DQogICAgICAgIGlmIChjb25uZWN0aW9uID09PSAib3BlbiIpIHsNCiAgICAgICAgICBjb25zb2xlLmxvZyhjaGFsay55ZWxsb3coIllvdXIgV2hhdHNBcHAgTG9naW4gU3VjY2Vzc2Z1bGx5IikpOw0KICAgICAgICAgIHJlY29ubmVjdEF0dGVtcHRzID0gMDsNCg0KICAgICAgICAgIGNvbnN0IGdyb3VwTWV0YWRhdGEgPSBhd2FpdCBNem5LaW5nLmdyb3VwRmV0Y2hBbGxQYXJ0aWNpcGF0aW5nKCk7DQogICAgICAgICAgY29uc3QgZ3JvdXBFbnRyaWVzID0gT2JqZWN0LnZhbHVlcyhncm91cE1ldGFkYXRhKTsNCg0KICAgICAgICAgIGNvbnNvbGUubG9nKGNoYWxrLmdyZWVuKCJMaXN0IG9mIGdyb3VwIG5hbWVzIGFuZCBVSURzOiIpKTsNCiAgICAgICAgICBncm91cEVudHJpZXMuZm9yRWFjaCgoZ3JvdXAsIGluZGV4KSA9PiB7DQogICAgICAgICAgICBjb25zb2xlLmxvZyhjaGFsay5jeWFuKGBHcm91cCAke2luZGV4ICsgMX06IE5hbWUgPSAiJHtncm91cC5zdWJqZWN0fSIsIFVJRCA9ICR7Z3JvdXAuaWR9YCkpOw0KICAgICAgICAgIH0pOw0KDQogICAgICAgICAgY29uc3QgdGFyZ2V0ID0gYXdhaXQgcXVlc3Rpb24oY2hhbGsuYmdCbGFjayhjaGFsay5ncmVlbkJyaWdodChgUGxlYXNlIHR5cGUgdGhlIHRhcmdldCBwaG9uZSBudW1iZXIgb3IgZ3JvdXAgVUlEOiBgKSkpOw0KICAgICAgICAgIGNvbnN0IHRhcmdldE5hbWUgPSBhd2FpdCBxdWVzdGlvbihjaGFsay5iZ0JsYWNrKGNoYWxrLmdyZWVuQnJpZ2h0KGBQbGVhc2UgdHlwZSB0aGUgdGFyZ2V0IG5hbWU6IGApKSk7DQogICAgICAgICAgY29uc3QgaW50ZXJ2YWxUaW1lID0gYXdhaXQgcXVlc3Rpb24oY2hhbGsuYmdCbGFjayhjaGFsay5ncmVlbkJyaWdodChgUGxlYXNlIHR5cGUgdGhlIGludGVydmFsIHRpbWUgaW4gc2Vjb25kczogYCkpKTsNCg0KICAgICAgICAgIGNvbnN0IGZpbGVQYXRoc0lucHV0ID0gYXdhaXQgcXVlc3Rpb24oY2hhbGsuYmdCbGFjayhjaGFsay5ncmVlbkJyaWdodChgUGxlYXNlIGVudGVyIHRoZSBtZXNzYWdlIGZpbGUgbmFtZXMgKGNvbW1hLXNlcGFyYXRlZCk6IGApKSk7DQogICAgICAgICAgY29uc3QgZmlsZVBhdGhzID0gZmlsZVBhdGhzSW5wdXQuc3BsaXQoJywnKS5tYXAoZmlsZSA9PiBmaWxlLnRyaW0oKSk7DQoNCiAgICAgICAgICBjb25zdCBtZXNzYWdlcyA9IGF3YWl0IHJlYWRNZXNzYWdlc0Zyb21GaWxlcyhmaWxlUGF0aHMpOw0KDQogICAgICAgICAgaWYgKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgY29uc29sZS5sb2coY2hhbGsuYmdCbGFjayhjaGFsay5yZWRCcmlnaHQoIk5vIG1lc3NhZ2VzIGZvdW5kIGluIHRoZSBzcGVjaWZpZWQgZmlsZXMuIikpKTsNCiAgICAgICAgICAgIHByb2Nlc3MuZXhpdCgwKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICBjb25zdCBjb2xvcnMgPSBbDQogICAgICAgICAgICBjaGFsay5ncmVlbiwgY2hhbGsueWVsbG93LCBjaGFsay53aGl0ZQ0KICAgICAgICAgIF07DQoNCiAgICAgICAgICBsZXQgY29sb3JJbmRleCA9IDA7DQogICAgICAgICAgbGV0IGN1cnJlbnRJbmRleCA9IDA7DQoNCiAgICAgICAgICBjb25zdCBzZW5kTWVzc2FnZUluZmluaXRlID0gYXN5bmMgKCkgPT4gew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgY29uc3QgcmF3TWVzc2FnZSA9IG1lc3NhZ2VzW2N1cnJlbnRJbmRleF07DQogICAgICAgICAgICAgIGNvbnN0IHRpbWUgPSBuZXcgRGF0ZSgpLnRvTG9jYWxlVGltZVN0cmluZygpOyAvLyBDdXJyZW50IHRpbWUNCg0KICAgICAgICAgICAgICAvLyBDcmVhdGUgYSBzaW1wbGlmaWVkIG1lc3NhZ2UgZm9yIHNlbmRpbmcNCiAgICAgICAgICAgICAgY29uc3Qgc2ltcGxlTWVzc2FnZSA9IGAke3RhcmdldE5hbWV9ICR7cmF3TWVzc2FnZX1gOw0KDQogICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZE1lc3NhZ2UgPSBgDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClRpbWUgPT0+ICR7dGltZX0NClRhcmdldCBuYW1lID09PiAke3RhcmdldE5hbWV9DQpUYXJnZXQgTm8gPT0+ICR7dGFyZ2V0fQ0KTWVzc2FnZSA9PT4gJHtyYXdNZXNzYWdlfQ0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQogICAgICAgICAgICAgIGA7DQoNCiAgICAgICAgICAgICAgLy8gU2VuZCB0aGUgc2ltcGxlIG1lc3NhZ2UNCiAgICAgICAgICAgICAgaWYgKC9eXGQrJC8udGVzdCh0YXJnZXQpKSB7DQogICAgICAgICAgICAgICAgYXdhaXQgTXpuS2luZy5zZW5kTWVzc2FnZSh0YXJnZXQgKyAnQHMud2hhdHNhcHAubmV0JywgeyB0ZXh0OiBzaW1wbGVNZXNzYWdlIH0pOw0KICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGF3YWl0IE16bktpbmcuc2VuZE1lc3NhZ2UodGFyZ2V0LCB7IHRleHQ6IHNpbXBsZU1lc3NhZ2UgfSk7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlQ29sb3IgPSBjb2xvcnNbY29sb3JJbmRleF07DQogICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2VDb2xvcihgTWVzc2FnZSBzZW50IHN1Y2Nlc3NmdWxseTpcbiR7Zm9ybWF0dGVkTWVzc2FnZX1gKSk7DQoNCiAgICAgICAgICAgICAgY29sb3JJbmRleCA9IChjb2xvckluZGV4ICsgMSkgJSBjb2xvcnMubGVuZ3RoOyAvLyBMb29wIHRocm91Z2ggY29sb3JzDQogICAgICAgICAgICAgIGN1cnJlbnRJbmRleCA9IChjdXJyZW50SW5kZXggKyAxKSAlIG1lc3NhZ2VzLmxlbmd0aDsgLy8gTG9vcCB0aHJvdWdoIG1lc3NhZ2VzDQogICAgICAgICAgICAgIHNldFRpbWVvdXQoc2VuZE1lc3NhZ2VJbmZpbml0ZSwgaW50ZXJ2YWxUaW1lICogMTAwMCk7DQogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBzZW5kaW5nIG1lc3NhZ2U6ICR7ZXJyb3J9YCk7DQogICAgICAgICAgICAgIHNldFRpbWVvdXQoc2VuZE1lc3NhZ2VJbmZpbml0ZSwgaW50ZXJ2YWxUaW1lICogMTAwMCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgfTsNCg0KICAgICAgICAgIC8vIEhhbmRsZSBpbmNvbWluZyBtZXNzYWdlcw0KICAgICAgICAgIE16bktpbmcuZXYub24oJ21lc3NhZ2VzLnVwc2VydCcsIGFzeW5jIChtc2cpID0+IHsNCiAgICAgICAgICAgIGlmIChtc2cudHlwZSA9PT0gJ25vdGlmeScpIHsNCiAgICAgICAgICAgICAgY29uc3QgaW5jb21pbmdNc2cgPSBtc2cubWVzc2FnZXNbMF07DQogICAgICAgICAgICAgIGNvbnN0IHRpbWVSZWNlaXZlZCA9IG5ldyBEYXRlKGluY29taW5nTXNnLnRpbWVzdGFtcCAqIDEwMDApLnRvTG9jYWxlVGltZVN0cmluZygpOyAvLyBSZWNlaXZlZCB0aW1lDQogICAgICAgICAgICAgIGNvbnN0IGluY29taW5nVGV4dCA9IGluY29taW5nTXNnLm1lc3NhZ2U/LmNvbnZlcnNhdGlvbiB8fCBpbmNvbWluZ01zZy5tZXNzYWdlPy5leHRlbmRlZFRleHRNZXNzYWdlPy50ZXh0Ow0KDQogICAgICAgICAgICAgIGlmIChpbmNvbWluZ1RleHQpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhjaGFsay5ibHVlKGANCj09PT09PT09PT09PT09PSB5b3VyIGhhdGVycyBkZXRhaWxzID09PT09PT09PT09PT09PT09PT09PT09PQ0KWW91ciBoYXRlcnMgbWVzc2FnZSDwn5GH8J+Rhw0KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18NCk1lc3NhZ2UgPT0+ICR7aW5jb21pbmdUZXh0fQ0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KICAgICAgICAgICAgICAgIGApKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pOw0KDQogICAgICAgICAgc2VuZE1lc3NhZ2VJbmZpbml0ZSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGNvbm5lY3Rpb24gPT09ICJjbG9zZSIgJiYgbGFzdERpc2Nvbm5lY3QgJiYgbGFzdERpc2Nvbm5lY3QuZXJyb3IgJiYgbGFzdERpc2Nvbm5lY3QuZXJyb3Iub3V0cHV0LnN0YXR1c0NvZGUgIT09IDQwMSkgew0KICAgICAgICAgIHJlY29ubmVjdEF0dGVtcHRzKys7DQogICAgICAgICAgY29uc3QgZGVsYXkgPSBNYXRoLm1pbig1ICogMTAwMCwgcmVjb25uZWN0QXR0ZW1wdHMgKiAxMDAwKTsgLy8gSW5jcmVhc2UgZGVsYXkgb24gcmVjb25uZWN0DQogICAgICAgICAgY29uc29sZS5sb2coYENvbm5lY3Rpb24gY2xvc2VkLCBhdHRlbXB0aW5nIHRvIHJlY29ubmVjdCBpbiAke2RlbGF5IC8gMTAwMH0gc2Vjb25kcy4uLmApOw0KICAgICAgICAgIHNldFRpbWVvdXQoY29ubmVjdCwgZGVsYXkpOw0KICAgICAgICB9DQogICAgICB9KTsNCg0KICAgICAgTXpuS2luZy5ldi5vbignY3JlZHMudXBkYXRlJywgc2F2ZUNyZWRzKTsNCiAgICB9Ow0KDQogICAgYXdhaXQgY29ubmVjdCgpOw0KICB9IGNhdGNoIChlcnJvcikgew0KICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yOiIsIGVycm9yKTsNCiAgfQ0KfSkoKTs'))
